/*
 * Sponsored License - for use in support of a program or activity
 * sponsored by MathWorks.  Not for government, commercial or other
 * non-sponsored organizational use.
 * File: cepstralCoefficients.c
 *
 * MATLAB Coder version            : 24.2
 * C/C++ source code generated on  : 15-Nov-2024 05:22:48
 */

/* Include Files */
#include "cepstralCoefficients.h"
#include "rt_nonfinite.h"
#include <math.h>
#include <string.h>

/* Function Definitions */
/*
 * Arguments    : double S_data[]
 *                const int S_size[2]
 *                double coeffs_data[]
 *                int coeffs_size[2]
 * Return Type  : void
 */
void cepstralCoefficients(double S_data[], const int S_size[2],
                          double coeffs_data[], int coeffs_size[2])
{
  static const double dv[520] = {
      0.15811388300841897,     0.22343440501258571,     0.22291749261751181,
      0.22205685760620389,     0.2208538270154693,      0.21931025583128155,
      0.2174285241285264,      0.21521153340109889,     0.21266270208800997,
      0.20978596030240149,     0.20658574377159641,     0.20306698699752895,
      0.19923511564810012,     0.15811388300841897,     0.22205685760620389,
      0.2174285241285264,      0.20978596030240149,     0.19923511564810012,
      0.18592225743338867,     0.17003194295780358,     0.15178446101891946,
      0.1314327780297834,      0.10925903112375324,     0.08557061686312839,
      0.060695929774142975,    0.03497980978537707,     0.15811388300841897,
      0.21931025583128155,     0.20658574377159641,     0.18592225743338867,
      0.15811388300841897,     0.1242292807307229,      0.08557061686312839,
      0.043623522178038679,    1.3691967456605066E-17,  -0.043623522178038644,
      -0.085570616863128376,   -0.12422928073072281,    -0.15811388300841894,
      0.15811388300841897,     0.21521153340109889,     0.19065613678423435,
      0.15178446101891946,     0.10151536185567273,     0.043623522178038679,
      -0.017543987150062449,   -0.077394126779744887,   -0.13143277802978337,
      -0.17560220413308489,    -0.20658574377159641,    -0.22205685760620389,
      -0.2208538270154693,     0.15811388300841897,     0.20978596030240149,
      0.17003194295780358,     0.10925903112375324,     0.03497980978537707,
      -0.043623522178038644,   -0.11683423088509345,    -0.17560220413308489,
      -0.21266270208800997,    -0.22343440501258571,    -0.20658574377159644,
      -0.16419950485064241,    -0.10151536185567274,    0.15811388300841897,
      0.20306698699752895,     0.14522099839208594,     0.060695929774142975,
      -0.034979809785377049,   -0.12422928073072281,    -0.19065613678423432,
      -0.22205685760620389,    -0.21266270208801,       -0.16419950485064241,
      -0.085570616863128515,   0.0087787616821394989,   0.10151536185567268,
      0.15811388300841897,     0.19509603819119117,     0.11683423088509348,
      0.0087787616821395041,   -0.10151536185567271,    -0.18592225743338867,
      -0.22291749261751181,    -0.20306698699752898,    -0.13143277802978343,
      -0.026282161061413584,   0.085570616863128432,    0.17560220413308486,
      0.2208538270154693,      0.15811388300841897,     0.18592225743338867,
      0.08557061686312839,     -0.043623522178038644,   -0.15811388300841894,
      -0.21931025583128155,    -0.20658574377159644,    -0.12422928073072287,
      -4.1075902369815195E-17, 0.1242292807307228,      0.20658574377159636,
      0.21931025583128155,     0.158113883008419,       0.15811388300841897,
      0.17560220413308494,     0.052199970261397707,    -0.0936151632575909,
      -0.19923511564810009,    -0.21931025583128155,    -0.14522099839208605,
      -0.0087787616821395822,  0.13143277802978334,     0.21521153340109889,
      0.20658574377159641,     0.10925903112375333,     -0.034979809785376792,
      0.15811388300841897,     0.16419950485064236,     0.017543987150062477,
      -0.1384336155115598,     -0.2208538270154693,     -0.18592225743338869,
      -0.052199970261397631,   0.10925903112375324,     0.21266270208800997,
      0.20306698699752898,     0.085570616863128529,    -0.077394126779744887,
      -0.19923511564810018,    0.15811388300841897,     0.15178446101891946,
      -0.017543987150062449,   -0.17560220413308489,    -0.2208538270154693,
      -0.12422928073072287,    0.052199970261397548,    0.19509603819119112,
      0.21266270208801,        0.093615163257590964,    -0.0855706168631284,
      -0.20978596030240143,    -0.19923511564810023,    0.15811388300841897,
      0.13843361551155978,     -0.052199970261397673,   -0.20306698699752895,
      -0.19923511564810012,    -0.043623522178038748,   0.145220998392086,
      0.22343440501258571,     0.13143277802978345,     -0.060695929774142843,
      -0.20658574377159633,    -0.19509603819119128,    -0.034979809785376952,
      0.15811388300841897,     0.1242292807307229,      -0.085570616863128376,
      -0.21931025583128155,    -0.158113883008419,      0.043623522178038672,
      0.20658574377159636,     0.18592225743338872,     6.8459837283025336E-17,
      -0.18592225743338864,    -0.20658574377159641,    -0.04362352217803861,
      0.15811388300841875,     0.15811388300841897,     0.10925903112375324,
      -0.11683423088509345,    -0.22343440501258571,    -0.10151536185567274,
      0.1242292807307228,      0.22291749261751181,     0.093615163257590964,
      -0.13143277802978334,    -0.22205685760620389,    -0.085570616863128557,
      0.13843361551155972,     0.2208538270154693,      0.15811388300841897,
      0.093615163257590964,    -0.14522099839208591,    -0.21521153340109891,
      -0.0349798097853771,     0.18592225743338867,     0.1906561367842344,
      -0.026282161061413477,   -0.21266270208800994,    -0.15178446101891963,
      0.08557061686312839,     0.22343440501258571,     0.101515361855673,
      0.15811388300841897,     0.0773941267797449,      -0.17003194295780355,
      -0.19509603819119115,    0.034979809785377014,    0.21931025583128153,
      0.11683423088509343,     -0.13843361551155975,    -0.21266270208801,
      -0.008778761682139636,   0.20658574377159633,     0.15178446101891963,
      -0.10151536185567278,    0.15811388300841897,     0.060695929774142975,
      -0.19065613678423432,    -0.16419950485064241,    0.10151536185567268,
      0.21931025583128155,     0.017543987150062629,    -0.20978596030240143,
      -0.13143277802978348,    0.13843361551155972,     0.20658574377159641,
      -0.026282161061413619,   -0.22085382701546927,    0.15811388300841897,
      0.043623522178038679,    -0.20658574377159641,    -0.12422928073072287,
      0.15811388300841892,     0.18592225743338872,     -0.0855706168631284,
      -0.21931025583128161,    -9.5843772196235458E-17, 0.21931025583128155,
      0.085570616863128585,    -0.18592225743338861,    -0.15811388300841892,
      0.15811388300841897,     0.026282161061413605,    -0.2174285241285264,
      -0.077394126779744984,   0.19923511564810009,     0.1242292807307229,
      -0.17003194295780347,    -0.1641995048506423,     0.13143277802978331,
      0.19509603819119128,     -0.085570616863128363,   -0.21521153340109894,
      0.034979809785376709,    0.15811388300841897,     0.0087787616821395041,
      -0.22291749261751181,    -0.026282161061413584,   0.2208538270154693,
      0.043623522178038776,    -0.21742852412852642,    -0.060695929774143,
      0.21266270208800994,     0.077394126779745054,    -0.20658574377159633,
      -0.093615163257590867,   0.19923511564810012,     0.15811388300841897,
      -0.0087787616821394781,  -0.22291749261751181,    0.026282161061413505,
      0.2208538270154693,      -0.043623522178038443,   -0.21742852412852645,
      0.060695929774142815,    0.21266270208801002,     -0.077394126779744818,
      -0.20658574377159658,    0.0936151632575906,      0.19923511564810026,
      0.15811388300841897,     -0.026282161061413577,   -0.21742852412852642,
      0.0773941267797449,      0.19923511564810015,     -0.12422928073072277,
      -0.17003194295780358,    0.16419950485064219,     0.13143277802978351,
      -0.19509603819119117,    -0.085570616863128612,   0.21521153340109886,
      0.034979809785377042,    0.15811388300841897,     -0.043623522178038644,
      -0.20658574377159644,    0.1242292807307228,      0.158113883008419,
      -0.18592225743338864,    -0.085570616863128557,   0.21931025583128155,
      1.2322770710944559E-16,  -0.21931025583128161,    0.085570616863128335,
      0.18592225743338855,     -0.15811388300841869,    0.15811388300841897,
      -0.060695929774142954,   -0.19065613678423435,    0.16419950485064236,
      0.10151536185567277,     -0.21931025583128158,    0.017543987150062466,
      0.20978596030240151,     -0.13143277802978329,    -0.13843361551155992,
      0.20658574377159647,     0.026282161061413917,    -0.2208538270154693,
      0.15811388300841897,     -0.077394126779744887,   -0.17003194295780361,
      0.19509603819119112,     0.034979809785377125,    -0.21931025583128161,
      0.11683423088509332,     0.13843361551155989,     -0.21266270208800994,
      0.0087787616821393914,   0.20658574377159658,     -0.15178446101891943,
      -0.10151536185567309,    0.15811388300841897,     -0.0936151632575909,
      -0.14522099839208605,    0.21521153340109889,     -0.034979809785376792,
      -0.18592225743338872,    0.19065613678423432,     0.026282161061413865,
      -0.21266270208801014,    0.15178446101891943,     0.085570616863128626,
      -0.22343440501258574,    0.10151536185567271,     0.15811388300841897,
      -0.10925903112375326,    -0.11683423088509341,    0.22343440501258571,
      -0.10151536185567284,    -0.12422928073072292,    0.22291749261751181,
      -0.093615163257590978,   -0.1314327780297832,     0.22205685760620389,
      -0.085570616863128307,   -0.13843361551155997,    0.22085382701546924,
      0.15811388300841897,     -0.12422928073072281,    -0.085570616863128515,
      0.21931025583128155,     -0.15811388300841878,    -0.04362352217803861,
      0.20658574377159641,     -0.18592225743338861,    -5.4781710654221935E-16,
      0.18592225743338855,     -0.20658574377159647,    0.0436235221780387,
      0.15811388300841897,     0.15811388300841897,     -0.1384336155115598,
      -0.052199970261397631,   0.20306698699752898,     -0.19923511564810018,
      0.043623522178038422,    0.1452209983920861,      -0.22343440501258571,
      0.13143277802978359,     0.06069592977414346,     -0.20658574377159661,
      0.19509603819119092,     -0.034979809785376632,   0.15811388300841897,
      -0.15178446101891938,    -0.0175439871500626,     0.17560220413308494,
      -0.22085382701546927,    0.12422928073072274,     0.052199970261397714,
      -0.19509603819119109,    0.2126627020880098,      -0.093615163257590575,
      -0.085570616863128654,   0.20978596030240154,     -0.19923511564810009,
      0.15811388300841897,     -0.16419950485064236,    0.017543987150062522,
      0.13843361551155986,     -0.2208538270154693,     0.18592225743338864,
      -0.052199970261397478,   -0.10925903112375324,    0.21266270208800989,
      -0.20306698699752881,    0.085570616863128279,    0.077394126779744776,
      -0.19923511564810031,    0.15811388300841897,     -0.17560220413308489,
      0.052199970261397548,    0.093615163257590964,    -0.19923511564810023,
      0.21931025583128155,     -0.14522099839208591,    0.0087787616821393914,
      0.13143277802978384,     -0.21521153340109897,    0.20658574377159647,
      -0.1092590311237529,     -0.034979809785377118,   0.15811388300841897,
      -0.18592225743338867,    0.085570616863128432,    0.043623522178038776,
      -0.15811388300841889,    0.21931025583128161,     -0.20658574377159633,
      0.12422928073072272,     -2.1920988758369781E-16, -0.124229280730723,
      0.20658574377159661,     -0.21931025583128153,    0.15811388300841864,
      0.15811388300841897,     -0.19509603819119112,    0.11683423088509336,
      -0.0087787616821394729,  -0.10151536185567298,    0.18592225743338875,
      -0.22291749261751181,    0.20306698699752881,     -0.13143277802978293,
      0.026282161061413539,    0.085570616863128682,    -0.1756022041330853,
      0.2208538270154693,      0.15811388300841897,     -0.20306698699752895,
      0.145220998392086,       -0.060695929774142843,   -0.034979809785376952,
      0.12422928073072294,     -0.19065613678423446,    0.22205685760620394,
      -0.21266270208801005,    0.16419950485064239,     -0.085570616863128265,
      -0.0087787616821398,     0.10151536185567314,     0.15811388300841897,
      -0.20978596030240146,    0.17003194295780347,     -0.10925903112375304,
      0.034979809785376764,    0.04362352217803863,     -0.11683423088509386,
      0.17560220413308528,     -0.21266270208801016,    0.22343440501258574,
      -0.20658574377159644,    0.16419950485064236,     -0.10151536185567192,
      0.15811388300841897,     -0.21521153340109889,    0.19065613678423435,
      -0.15178446101891949,    0.10151536185567281,     -0.043623522178038387,
      -0.017543987150062317,   0.077394126779744735,    -0.13143277802978326,
      0.1756022041330853,      -0.20658574377159664,    0.22205685760620397,
      -0.22085382701546932,    0.15811388300841897,     -0.21931025583128155,
      0.20658574377159636,     -0.18592225743338864,    0.15811388300841875,
      -0.12422928073072272,    0.085570616863128335,    -0.043623522178038734,
      -6.0258497636863966E-16, 0.04362352217803913,     -0.08557061686312871,
      0.12422928073072374,     -0.15811388300841905,    0.15811388300841897,
      -0.22205685760620389,    0.21742852412852642,     -0.20978596030240143,
      0.19923511564810015,     -0.18592225743338861,    0.17003194295780341,
      -0.15178446101891943,    0.13143277802978354,     -0.1092590311237529,
      0.085570616863128238,    -0.06069592977414226,    0.034979809785376549,
      0.15811388300841897,     -0.22343440501258571,    0.22291749261751181,
      -0.22205685760620386,    0.22085382701546927,     -0.21931025583128155,
      0.21742852412852631,     -0.21521153340109886,    0.2126627020880098,
      -0.2097859603024014,     0.20658574377159644,     -0.20306698699752876,
      0.1992351156480997};
  static const signed char iv[3] = {2, 1, 3};
  double b_coeffs_data[247];
  int b_coeffs_size[2];
  int aoffset;
  int b_i;
  int boffset;
  int i;
  int idx;
  int j;
  int k;
  int nc;
  short ii_data[760];
  bool x_data[760];
  bool b;
  bool exitg1;
  nc = S_size[1];
  aoffset = 40 * S_size[1];
  for (i = 0; i < aoffset; i++) {
    x_data[i] = (S_data[i] == 0.0);
  }
  idx = 0;
  boffset = 0;
  exitg1 = false;
  while ((!exitg1) && (boffset <= aoffset - 1)) {
    if (x_data[boffset]) {
      idx++;
      ii_data[idx - 1] = (short)(boffset + 1);
      if (idx >= aoffset) {
        exitg1 = true;
      } else {
        boffset++;
      }
    } else {
      boffset++;
    }
  }
  if (idx < 1) {
    idx = 0;
  }
  if (idx != 0) {
    idx--;
    for (i = 0; i <= idx; i++) {
      S_data[ii_data[i] - 1] = 2.2250738585072014E-308;
    }
  }
  for (k = 0; k < aoffset; k++) {
    S_data[k] = log10(S_data[k]);
  }
  for (j = 0; j < nc; j++) {
    idx = j * 13;
    boffset = j * 40;
    memset(&b_coeffs_data[idx], 0, 13U * sizeof(double));
    for (k = 0; k < 40; k++) {
      double bkj;
      aoffset = k * 13;
      bkj = S_data[boffset + k];
      for (b_i = 0; b_i < 13; b_i++) {
        i = idx + b_i;
        b_coeffs_data[i] += dv[aoffset + b_i] * bkj;
      }
    }
  }
  b_coeffs_size[0] = 13;
  b_coeffs_size[1] = S_size[1];
  b = true;
  idx = 0;
  k = 0;
  exitg1 = false;
  while ((!exitg1) && (k < 3)) {
    if (iv[k] <= 2) {
      i = b_coeffs_size[iv[k] - 1];
    } else {
      i = 1;
    }
    if (i != 1) {
      if (idx > iv[k]) {
        b = false;
        exitg1 = true;
      } else {
        idx = iv[k];
        k++;
      }
    } else {
      k++;
    }
  }
  if (b) {
    coeffs_size[0] = S_size[1];
    coeffs_size[1] = 13;
    aoffset = S_size[1] * 13;
    if (aoffset - 1 >= 0) {
      memcpy(&coeffs_data[0], &b_coeffs_data[0],
             (unsigned int)aoffset * sizeof(double));
    }
  } else {
    coeffs_size[0] = S_size[1];
    coeffs_size[1] = 13;
    for (k = 0; k < nc; k++) {
      for (idx = 0; idx < 13; idx++) {
        coeffs_data[k + coeffs_size[0] * idx] = b_coeffs_data[idx + 13 * k];
      }
    }
  }
}

/*
 * File trailer for cepstralCoefficients.c
 *
 * [EOF]
 */
